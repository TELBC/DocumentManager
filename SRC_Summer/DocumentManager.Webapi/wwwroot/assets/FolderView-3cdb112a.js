import{_ as b,o as i,c as u,a as o,w as G,d as m,v as V,F as v,r as D,t as a,e as g,b as h,p as _,f as w,n as E,g as O,h as y,C,i as f,j as p,L as I}from"./index-93983857.js";const F={props:{document:{type:Object,required:!0},guids:{type:Array,required:!0},documents:{type:Array,required:!0}},data(){return{show:!1,editedDocument:{}}},watch:{"editedDocument.guid":{immediate:!0,handler(t){const e=this.documents.find(d=>d.guid===t);e&&(this.editedDocument.title=e.title,this.editedDocument.content=e.content,this.editedDocument.tags=e.tags,this.editedDocument.version=e.version)}}},methods:{open(){this.editedDocument={...this.document},this.show=!0},close(){this.show=!1},closeOnOverlayClick(t){t.target===t.currentTarget&&this.close()},cancel(){this.close()},submit(){this.$emit("document-edited",this.editedDocument),this.close()},async updateContent(){const t=this.documents.find(e=>e.guid===this.editedDocument.guid);t&&(this.editedDocument.content=t.content)}}},c=t=>(_("data-v-7910f1ee"),t=t(),w(),t),U={class:"edit-dialog"},j=c(()=>o("h2",null,"Edit Document",-1)),q=c(()=>o("label",{for:"guid"},"GUID:",-1)),M=["value"],A=c(()=>o("label",{for:"title"},"Title:",-1)),B=c(()=>o("label",{for:"content"},"Content:",-1)),T=c(()=>o("label",{for:"tags"},"Tags:",-1)),L=c(()=>o("label",{for:"version"},"Version:",-1)),N={class:"edit-dialog-actions"},R=c(()=>o("button",{type:"submit"},"Save",-1));function W(t,e,d,s,l,r){return l.show?(i(),u("div",{key:0,class:"edit-dialog-overlay",onClick:e[8]||(e[8]=n=>r.closeOnOverlayClick(n))},[o("div",U,[j,o("form",{onSubmit:e[7]||(e[7]=G((...n)=>r.submit&&r.submit(...n),["prevent"]))},[q,m(o("select",{id:"guid","onUpdate:modelValue":e[0]||(e[0]=n=>l.editedDocument.guid=n),class:"custom-select",onChange:e[1]||(e[1]=(...n)=>r.updateContent&&r.updateContent(...n))},[(i(!0),u(v,null,D(d.guids,n=>(i(),u("option",{key:n,value:n},a(n),9,M))),128))],544),[[V,l.editedDocument.guid]]),A,m(o("input",{type:"text",id:"title","onUpdate:modelValue":e[2]||(e[2]=n=>l.editedDocument.title=n)},null,512),[[g,l.editedDocument.title]]),B,m(o("textarea",{id:"content","onUpdate:modelValue":e[3]||(e[3]=n=>l.editedDocument.content=n)},null,512),[[g,l.editedDocument.content]]),T,m(o("input",{type:"text",id:"tags","onUpdate:modelValue":e[4]||(e[4]=n=>l.editedDocument.tags=n)},null,512),[[g,l.editedDocument.tags]]),L,m(o("input",{type:"text",id:"version","onUpdate:modelValue":e[5]||(e[5]=n=>l.editedDocument.version=n)},null,512),[[g,l.editedDocument.version]]),o("div",N,[o("button",{type:"button",onClick:e[6]||(e[6]=(...n)=>r.cancel&&r.cancel(...n))},"Cancel"),R])],32)])])):h("",!0)}const k=b(F,[["render",W],["__scopeId","data-v-7910f1ee"]]);const $=t=>(_("data-v-2bfb7ecf"),t=t(),w(),t),z={class:"document-container"},H={class:"document"},J=["title"],K=["title"],P=$(()=>o("i",{class:"fa-solid fa-tag tag-icon"},null,-1)),Q={key:0,class:"tag-list"},X=["title"],Y=$(()=>o("div",{class:"actions"},[o("span",{class:"loadContent"},[o("i",{class:"fa-solid fa-file"})])],-1)),Z={class:"documentContent"},x={class:"document-actions"},ee={props:{document:{type:Object,required:!0},documents:{type:Array,required:!0}},data(){return{loading:!1,loadedDocument:null,hover:!1,showContent:!1,guids:[]}},components:{ConfirmDialog:C,EditDocumentDialog:k},methods:{async loadContent(t){if(!this.loading)try{this.loading=!0,this.loadedDocument=(await f.get(`folders/${this.folderGuid}/${t}`)).data,this.showContent=!this.showContent}catch{alert("Server was unable to load document.")}finally{this.loading=!1}},getDocument(t){return this.loadedDocument&&this.loadedDocument.guid===t?this.loadedDocument.content:null},async confirmDelete(){if(await this.$refs.confirmDialog.open())try{await f.delete(`documents/${this.document.guid}`),this.$emit("document-deleted",this.document.guid)}catch{alert("Error deleting the document")}},async editDocument(){this.$refs.editDialog.open()},async fetchGuids(){if(!this.loading)try{const t=await f.get(`folders/${this.folderGuid}`);this.guids=t.data.documents.map(e=>e.guid)}catch{alert("ERROR fetching guids")}finally{this.loading=!1}}},computed:{folderGuid(){return this.$route.params.id},versionStyle(){return this.document.tags.length>0?{}:{flexGrow:1}}},mounted(){this.fetchGuids()}},te=Object.assign(ee,{__name:"DocumentComponent",setup(t){return(e,d)=>(i(),u(v,null,[o("div",z,[o("div",H,[o("div",{class:"documentsHeader",onClick:d[2]||(d[2]=s=>e.loadContent(t.document.guid))},[o("div",{class:"title",title:t.document.title},a(t.document.title),9,J),o("div",{class:"version",title:t.document.version,style:E(e.versionStyle)}," v."+a(t.document.version),13,K),t.document.tags.length>0&&!e.show?(i(),u("div",{key:0,class:"tags",onMouseover:d[0]||(d[0]=s=>e.hover=!0),onMouseleave:d[1]||(d[1]=s=>e.hover=!1)},[P,e.hover?(i(),u("div",Q,[o("ul",null,[(i(!0),u(v,null,D(t.document.tags,s=>(i(),u("li",{key:s},a(s),1))),128))])])):h("",!0)],32)):h("",!0),o("div",{class:"type",title:t.document.type},"."+a(t.document.type),9,X),Y]),o("div",Z,[m(o("div",null,a(e.getDocument(t.document.guid)),513),[[O,e.showContent]])])]),o("div",x,[o("button",{class:"edit-button",onClick:d[3]||(d[3]=(...s)=>e.editDocument&&e.editDocument(...s))},"Edit"),o("button",{class:"delete-button",onClick:d[4]||(d[4]=(...s)=>e.confirmDelete&&e.confirmDelete(...s))},"Delete")])]),y(C,{ref:"confirmDialog",title:"Delete Document",message:"Are you sure you want to delete this document?"},null,512),y(k,{ref:"editDialog",document:t.document,documents:t.documents,guids:e.guids,onDocumentEdited:e.updateDocument},null,8,["document","documents","guids","onDocumentEdited"])],64))}}),S=b(te,[["__scopeId","data-v-2bfb7ecf"]]),oe={class:"folderView"},ne={class:"folders"},de={key:0,class:"documents"},se={components:{DocumentComponent:S},data(){return{folder:{},loading:!1}},methods:{async loadFolder(){this.loading=!0;try{this.folder=(await f.get(`folders/${this.folderGuid}`)).data}catch{alert("Server was unable to load folder.")}finally{this.loading=!1}}},async mounted(){this.loadFolder(),this.loading=!0;try{this.folder=(await f.get(`folders/${this.folderGuid}`)).data}catch{alert("Server was unable to load folder.")}finally{this.loading=!1}},computed:{folderGuid(){return this.$route.params.id}}},le=Object.assign(se,{__name:"FolderView",setup(t){return(e,d)=>(i(),u("div",oe,[e.loading?(i(),p(I,{key:0})):h("",!0),o("h1",null,a(e.folder.name),1),o("div",ne,[o("h4",null,"guid: "+a(e.folderGuid),1),e.folder.documents?(i(),u("div",de,[(i(!0),u(v,null,D(e.folder.documents,s=>(i(),p(S,{key:s.guid,document:s,documents:e.folder.documents,onDocumentDeleted:e.loadFolder},null,8,["document","documents","onDocumentDeleted"]))),128))])):h("",!0)])]))}});export{le as default};
